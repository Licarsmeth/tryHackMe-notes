
## Wireshark
### 1. Packet Filtering
- **Capture Filter**
	- Used to save only a specific part of the traffic. It is set before capturing traffic and not changeable during the capture.
	- Basic syntax
		-   **Scope:** host, net, port and portrange.
		-   **Direction:** src, dst, src or dst, src and dst,
		-   **Protocol:** ether, wlan, ip, ip6, arp, rarp, tcp and udp.
		-   **Sample filter to capture port 80 traffic:** `tcp port 80`
		- More syntax [here](https://www.wireshark.org/docs/man-pages/pcap-filter.html) and [here](https://gitlab.com/wireshark/wireshark/-/wikis/CaptureFilters#useful-filters). 
		- Quick reference in wireshark under Capture -> Capture Filter
- **Display Filter**
	- Used to investigate packets by reducing the number of visible packets, and it is changeable during the capture.
	- Use alongside **"View --> Coloring Rules"** menu to assign colours to highlight your display filter results.
	- **Note:** You cannot use the display filter expressions for capturing traffic and vice versa.
	- "[Display Filter Reference](https://www.wireshark.org/docs/dfref/)" provides all supported protocols
	- ***Common examples***
		- **Basic Protocols**
			-   `tcp` - TCP traffic only    
			-   `udp` - UDP traffic only    
			-   `http` - HTTP requests/responses    
			-   `dns` - DNS queries/replies    
			-   `arp` - ARP requests/replies
		- **IP Addressing**
			-   `ip.addr == 10.80.175.19` - Specific IP (src or dst)    
			-   `ip.src == 192.168.1.100` - Source IP    
			-   `ip.dst == 10.0.0.1` - Destination IP    
			-   `ip.addr == 10.0.0.0/24` - Entire subnet
		- **Ports**
			-   `tcp.port == 80` - Port 80 traffic    
			-   `tcp.port == 443 or tcp.port == 80` - HTTP/HTTPS    
			-   `tcp.dstport == 22` - SSH destination
		- **HTTP Filters**
			-   `http.request` - HTTP requests only    
			-   `http.response` - HTTP responses only    
			-   `http.request.method == "GET"` - GET requests    
			-   `http.response.code == 200` - 200 OK responses    
			-   `http contains "login"` - HTTP bodies with "login"
		- **DNS Queries/Replies**
			-   `dns` - All DNS traffic    
			-   `dns.qry.name` - DNS queries only    
			-   `dns.resp` - DNS responses only    
			-   `dns.qry.name contains "google"` - Queries for google domains    
			-   `dns.qry.type == 0x0001` - A record queries (IPv4)    
			-   `dns.qry.type == 0x001c` - AAAA record queries (IPv6)    
			-   `dns contains "8.8.8.8"` - DNS responses with specific IP
		- **TCP Analysis**
			-   `tcp.flags.syn == 1` - TCP SYN packets    
			-   `tcp.flags.fin == 1` - TCP FIN packets    
			-   `tcp.analysis.retransmission` - Retransmissions    
			-   `tcp.analysis.lost_segment` - Lost segments
		- **Advanced Filtering**
			-   `http.server contains "Apache"` - HTTP packets where packets' "server" field contains the "Apache" keyword.
			-   `dns contains "8.8.8.8"` - DNS responses with IP    
			-   `frame.len < 100` - Small packets only    
			-   `tcp.srcport in {80 443 8080}` - Specific source ports list (no comma)
			-   `http.request.uri matches "/admin.*"` - Regex pattern matching    
			-   `upper(dns.qry.name) contains "GOOGLE"` - Case-insensitive contains    
			-   `lower(http.request.method) == "get"` - Lowercase string comparison
			- `string(frame.number) matches "[13579]$"` - Convert all "frame number" fields to string values, and list frames end with odd values.
				- more string examples
				-   `string(tcp.srcport) contains "44"` - Catches source ports like 443, 1443, 440    
				-   `string(ip.id) matches "^0x"` - IP identification fields starting with hex prefix    
				-   `string(frame.protocols) contains "http"` - Packets with "http" in protocol stack

		- **Workflow Features**
			-   **Profiles**: File -> Profiles -> Save current filters/layouts as reusable profile    
				- You can use the **"Edit --> Configuration Profiles"** menu or the **"lower right bottom of the status bar --> Profile"** section to create, modify and change the profile configuration.
			-   **Filter Bookmarks**: Apply filter → Bookmarks → "Save current" → name it
			-   **Coloring Rules**: Right-click packet → Color → New Rule → filter-based highlighting    
			-   **IO Graph**: Statistics → IO Graph → add filters for traffic volume visualization
		- **Errors & Issues**
			-   `tcp.analysis.flags` - Any TCP issues    
			-   `icmp` - ICMP traffic (ping, etc.)    
			-   `frame.len < 100` - Small packets only
		- **Exclusions**
			-   `!(arp or icmp or dns)` - Hide noise protocols    
			-   `!http` - Non-HTTP traffic	
		- **When you forget**
			- It's impossible to remember it all. So either google or look at the **"Analyse -> Display Filter Expression"** menu.
			-  There are TONS of options here so it's kinda hard to find what you're looking for exactly. Just know it exists, and use it if for some reason google doesn't give the answer. 

### 2. Recognizing patterns



<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIxMjcwNTQzODYsMTUwMTEzMTQ1MF19
-->